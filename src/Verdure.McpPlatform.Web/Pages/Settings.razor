@page "/settings"
@attribute [Authorize]
@using Microsoft.Extensions.Localization
@using Verdure.McpPlatform.Web.Resources
@inject IStringLocalizer<SharedResources> Loc

<PageTitle>@Loc["Settings"] - @Loc["AppTitle"]</PageTitle>

<MudGrid>
    <!-- M3 Hero Banner - 统一蓝色渐变 -->
    <MudItem xs="12">
        <MudCard Elevation="2" Style="background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%); border-radius: 16px; overflow: hidden;" Class="m3-mb-xl">
            <MudCardContent Class="pa-6">
                <div class="d-flex align-center mb-2">
                    <MudIcon Icon="@Icons.Material.Filled.Settings" Size="Size.Large" Style="color: #FFFFFF; margin-right: 12px;" />
                    <MudText Typo="Typo.h4" Style="color: #FFFFFF; font-weight: 600; margin: 0;">
                        @Loc["Settings"]
                    </MudText>
                </div>
                <MudText Typo="Typo.body1" Style="color: rgba(255, 255, 255, 0.85); margin-left: 48px;">
                    @Loc["ManageAccountPreferences"]
                </MudText>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" md="8">
        <MudCard Elevation="2">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">@Loc["AccountInformation"]</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <AuthorizeView>
                    <Authorized>
                        <MudGrid>
                            <MudItem xs="12">
                                <MudText Typo="Typo.body2" Color="Color.Secondary">@Loc["Username"]</MudText>
                                <MudText Typo="Typo.body1" Style="font-weight: 500;">@context.User.Identity?.Name</MudText>
                            </MudItem>
                            @if (context.User.Claims.Any())
                            {
                                <MudItem xs="12">
                                    <MudDivider Class="my-2" />
                                    <MudText Typo="Typo.body2" Color="Color.Secondary" Class="mb-2">@Loc["UserClaims"]</MudText>
                                    <MudSimpleTable Dense="true" Style="overflow-x: auto;">
                                        <thead>
                                            <tr>
                                                <th>@Loc["ClaimType"]</th>
                                                <th>@Loc["Value"]</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var claim in context.User.Claims.Take(10))
                                            {
                                                <tr>
                                                    <td>@claim.Type</td>
                                                    <td style="word-break: break-all;">@claim.Value</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </MudSimpleTable>
                                </MudItem>
                            }
                        </MudGrid>
                    </Authorized>
                </AuthorizeView>
            </MudCardContent>
        </MudCard>
    </MudItem>

    <MudItem xs="12" md="8">
        <MudCard Elevation="2">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">About</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText Typo="Typo.body2" Class="mb-2">
                    <strong>Verdure MCP Platform</strong> is a powerful management platform for MCP (Model Context Protocol) services 
                    with Xiaozhi AI integration.
                </MudText>
                <MudText Typo="Typo.body2" Color="Color.Secondary">
                    Configure your Keycloak settings in appsettings.json to enable full OIDC authentication.
                </MudText>
            </MudCardContent>
        </MudCard>
    </MudItem>
</MudGrid>
